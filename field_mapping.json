{
  "version": "2.0",
  "last_updated": "2025-11-20",
  "notes": "Field mapping from JotForm to CSD Portal - Customized for CBC workflow.",
  "csd_required_fields": {
    "ctl00_cphBody_txtProjectName": "Project Name (from lotAnd)",
    "ctl00_cphBody_ddlProvince": "Province/State (defaults to 24=Georgia)"
  },
  "due_date_calculation": {
    "enabled": true,
    "days_from_submission": 14,
    "notes": "Auto-calculate due date as submission date + 14 days"
  },
  "mappings": [
    {
      "jotform_field": "builderName",
      "jotform_label": "Builder Name",
      "csd_field": "ctl00_cphBody_txtBuilderName",
      "csd_field_type": "text",
      "required": true,
      "transform": null,
      "notes": "Main builder/company name"
    },
    {
      "jotform_field": "lotAnd",
      "jotform_label": "Lot and Subdivision",
      "csd_field": "ctl00_cphBody_txtProjectName",
      "csd_field_type": "text",
      "required": true,
      "transform": null,
      "notes": "Lot and subdivision -> Project Name (CSD REQUIRED field)"
    },
    {
      "jotform_field": "planName",
      "jotform_label": "Plan Name",
      "csd_field": "ctl00_cphBody_txtPlanName",
      "csd_field_type": "text",
      "required": false,
      "transform": null,
      "notes": "Design plan name"
    },
    {
      "jotform_field": "foundationType",
      "jotform_label": "Foundation Type",
      "csd_field": "COMPOSITE_NOTES",
      "csd_field_type": "composite",
      "required": true,
      "transform": "append_to_notes",
      "options": ["Slab", "Basement", "Crawlspace"],
      "notes": "No direct CSD field - will be added to special instructions/notes"
    },
    {
      "jotform_field": "roofType",
      "jotform_label": "Roof Type",
      "csd_field": "COMPOSITE_NOTES",
      "csd_field_type": "composite",
      "required": true,
      "transform": "append_to_notes",
      "options": ["Stick Built", "Trussed by Others", "Trussed by CBC"],
      "notes": "TEMPORARILY moved to notes to test if radio button causes event validation error"
    },
    {
      "jotform_field": "jobNotes",
      "jotform_label": "Job Notes",
      "csd_field": "COMPOSITE_NOTES",
      "csd_field_type": "composite",
      "required": false,
      "transform": "append_to_notes",
      "notes": "Combined into special instructions field"
    },
    {
      "jotform_field": "isThis",
      "jotform_label": "Is this a sold job?",
      "csd_field": "COMPOSITE_NOTES",
      "csd_field_type": "composite",
      "required": true,
      "transform": "append_to_notes",
      "options": ["YES", "NO"],
      "notes": "No direct CSD field - will be added to notes as 'Sold Job: YES/NO'"
    },
    {
      "jotform_field": "salesman",
      "jotform_label": "Salesman",
      "csd_field": "ctl00_cphBody_txtSubmittedBy",
      "csd_field_type": "text",
      "required": true,
      "transform": null,
      "notes": "Salesperson mapped to 'Submitted By' Name field"
    },
    {
      "jotform_field": "salesmanPhone",
      "jotform_label": "Salesman Phone",
      "csd_field": "ctl00_cphBody_txtPhone",
      "csd_field_type": "tel",
      "required": false,
      "transform": null,
      "default_value": "6788282117",
      "notes": "Submitted By Phone - uses default if not provided by JotForm"
    },
    {
      "jotform_field": "salesmanEmail",
      "jotform_label": "Salesman Email",
      "csd_field": "ctl00_cphBody_txtEmail",
      "csd_field_type": "email",
      "required": false,
      "transform": null,
      "default_value": "FBDesign@contractlumber.com",
      "notes": "Submitted By Email - uses default if not provided by JotForm"
    },
    {
      "jotform_field": "maximumJoist",
      "jotform_label": "Maximum Joist Spacing",
      "csd_field": "COMPOSITE_NOTES",
      "csd_field_type": "composite",
      "required": false,
      "transform": "append_to_notes",
      "notes": "Added to special instructions"
    },
    {
      "jotform_field": "typeA",
      "jotform_label": "Market",
      "csd_field": "COMPOSITE_NOTES",
      "csd_field_type": "composite",
      "required": false,
      "transform": "append_to_notes",
      "skip_if_empty": false,
      "options": ["Atlanta Market", "Statesville Market"],
      "notes": "Market selection goes to special instructions"
    },
    {
      "jotform_field": "joistDepth",
      "jotform_label": "Joist Depth Preference",
      "csd_field": "JOIST_DEPTH_DYNAMIC",
      "csd_field_type": "dynamic",
      "required": false,
      "transform": "map_to_joist_fields",
      "options": ["Per Designer", "11 7/8\"", "14\"", "16\""],
      "notes": "Maps to floor level joist depth fields (dynamic section)"
    },
    {
      "jotform_field": "chooseAny",
      "jotform_label": "Additional Options",
      "csd_field": "COMPOSITE_NOTES",
      "csd_field_type": "composite",
      "required": false,
      "transform": "append_to_notes",
      "skip_if_empty": true,
      "options": [
        "Sealed Engineered Layout",
        "Permit Drawing",
        "Follow Structurals",
        "Floor by Others"
      ],
      "notes": "Multiple options - only add to notes if selected"
    },
    {
      "jotform_field": "ifRoof",
      "jotform_label": "Truss Company",
      "csd_field": "COMPOSITE_NOTES",
      "csd_field_type": "composite",
      "required": false,
      "transform": "append_to_notes",
      "skip_if_empty": true,
      "notes": "Truss company name - only add to notes if provided"
    },
    {
      "jotform_field": "preferredManufacturer",
      "jotform_label": "Preferred Manufacturer",
      "csd_field": "rblHangerManufactuerer",
      "csd_field_type": "radio",
      "required": false,
      "transform": "map_manufacturer",
      "value_mapping": {
        "Boise": "NOTES",
        "Blue Linx": "NOTES",
        "PWT": "NOTES",
        "Trus Joist": "NOTES",
        "Trimmable Open Web": "NOTES",
        "Plated Floor Trusses": "NOTES"
      },
      "options": [
        "Boise",
        "Blue Linx",
        "PWT",
        "Trus Joist",
        "Trimmable Open Web",
        "Plated Floor Trusses"
      ],
      "notes": "Manufacturer preferences added to notes (CSD only has Simpson/USP for hangers)"
    },
    {
      "jotform_field": "fireplaceConstruction",
      "jotform_label": "Fireplace Construction",
      "csd_field": "COMPOSITE_NOTES",
      "csd_field_type": "composite",
      "required": false,
      "transform": "append_to_notes",
      "skip_if_empty": true,
      "options": [
        "Per Plan",
        "Masonry",
        "Full-Height Brick",
        "Mantel-Height Brick",
        "No Brick"
      ],
      "notes": "Fireplace details - only add to notes if selected"
    },
    {
      "jotform_field": "attachPlans",
      "jotform_label": "Attached Plans",
      "csd_field": "COMPOSITE_NOTES",
      "csd_field_type": "composite",
      "required": false,
      "transform": "file_links_to_notes",
      "skip_if_empty": true,
      "notes": "File URLs added to notes - files stored in JotForm, links provided for access"
    }
  ],
  "conditional_fields": {
    "ifRoof": {
      "show_when": {
        "roofType": "Trussed by Others"
      }
    }
  },
  "composite_notes_template": "=== Design Request Details ===\n\n{notes_content}\n\n---\nSubmitted via automated integration from JotForm\nJotForm Submission ID: {submission_id}"
}
